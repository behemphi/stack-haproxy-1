containers:
  nginx-backend-eg:
    scheduler: random
    availability: per-pool
    instances:
      min: 3
      max: 3
      default: 3
    config:
      image: "stackhub/nginx-backend-eg:latest"
      ports:
        - protocol: tcp
          container_port: "80"
    host_config:
      restart_policy: {}
  haproxy:
    scheduler: random
    availability: per-pool
    instances:
      min: 1
      max: 1
      default: 1
    config:
      image: "stackhub/haproxy:0.2.0"
      env:
        SE_API_TOKEN: 0c4c498808fc0b79
        SE_LEADER_IP: 172.31.19.80
        SE_SERVICE_DISCOVERY_KEY: haproxy-nginx-nginx-backend-eg-80
      ports:
        - protocol: tcp
          host_port: "80"
          container_port: "5000"
        - host_port: "1936"
          protocol: tcp
          container_port: "1936"
    host_config:
      restart_policy: {}
